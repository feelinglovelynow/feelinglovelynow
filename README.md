# Feeling Lovely Now

#### Docs
- [Svelte](https://svelte.dev/docs)
- [SvelteKit](https://kit.svelte.dev/docs/introduction)
- [SvelteKit SVG](https://www.npmjs.com/package/@poppanator/sveltekit-svg)
- [Svelte Jester](https://www.npmjs.com/package/svelte-jester)
- [Svelte Code Checker](https://www.npmjs.com/package/svelte-check)
- [Svelte Testing Library](https://testing-library.com/docs/svelte-testing-library/api)
- [Cloudflare Workers](https://kit.svelte.dev/docs/adapter-cloudflare-workers)
- [Cloudflare Workers KV](https://developers.cloudflare.com/workers/runtime-apis/kv)
- [Cloudflare Images](https://developers.cloudflare.com/images/)
- [Cloudflare Turnstile](https://developers.cloudflare.com/turnstile/)
- [Cloudflare Environments](https://developers.cloudflare.com/workers/wrangler/configuration/)
- [Cloudflare Compatibility Dates](https://developers.cloudflare.com/workers/configuration/compatibility-dates/#change-history)
- [Cloudflare API Docs](https://developers.cloudflare.com/api/operations/workers-kv-namespace-read-key-value-pair)
- [Cloudflare API Fundamentals](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/)
- [Cloudflare Custom Domains](https://developers.cloudflare.com/workers/configuration/routing/custom-domains/)
- [Paypal Options](https://developer.paypal.com/sdk/js/reference/)
- [Paypal API](https://developer.paypal.com/docs/api/orders/v2/#orders_create)
- [Paypal JS](https://www.npmjs.com/package/@paypal/paypal-js)
- [Printful API](https://developers.printful.com/docs/#tag/Products-API)
- [JSDOC + Typescript](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html)
- [Vitest](https://vitest.dev/api/)
- [Jest](https://jestjs.io/docs/api)
- [Istanbul Code Coverage](https://github.com/the-bugging/istanbul-badges-readme/blob/develop/README.md#advanced-usage-arguments)
- [Zod](https://zod.dev/)
- [Validator](https://github.com/validatorjs/validator.js)
- [Sass](https://sass-lang.com/documentation/)
- [PNPM](https://pnpm.io/motivation)
- [Buffer](https://www.npmjs.com/package/buffer)
- [Vite](https://vitejs.dev/)
- [Wrangler](https://developers.cloudflare.com/workers/wrangler/)
- [Typescript](https://www.npmjs.com/package/typescript)
- [Markdown](https://www.markdownguide.org/basic-syntax)
- [Open Graph](https://ogp.me/)
- [CSP](https://w3c.github.io/webappsec-csp/)
- [Volta](https://volta.sh/)
- [Weaviate](https://weaviate.io/)


#### Code Examples
- [Sveltekit + Turnstile](https://github.com/ghostdevv/svelte-turnstile)
- [Constructor Hover Typescript](https://stackoverflow.com/a/58461269/1549471)
- [Vitest + Svelte](https://stackblitz.com/edit/vitest-dev-vitest-dv3yuv?file=package.json&initialPath=__vitest__/)
- [Vitest + SvelteKit](https://stackblitz.com/edit/vitest-dev-vitest-rfr2d4?file=test%2Fhello.test.ts&initialPath=__vitest__/)
- [JEST + Fetch](https://stackoverflow.com/a/74128806/1549471)
- [Jsdoc Extends](https://stackoverflow.com/a/55358934/1549471)
- [Jsdoc Import](https://stackoverflow.com/a/73232942/1549471)
- [Durable Object Counter](https://developers.cloudflare.com/durable-objects/examples/build-a-counter/)
- [Mongodb Stop Words](https://github.com/igorbrigadir/stopwords/blob/master/en/mongodb.txt)
- [Array Intersection](https://stackoverflow.com/a/43820518/1549471)
- [Package.json + Bin + NPM Link](https://medium.com/nerd-for-tech/what-bin-does-in-package-json-931d691b1e33)
- [Stop Readline](https://stackoverflow.com/a/57798824)
- [Double type cast](https://stackoverflow.com/a/71464992)


#### Articles
- [NPM to PNPM](https://britishgeologicalsurvey.github.io/development/migrating-from-npm-to-pnpm/)
- [Cloudflare Worker Explanation](https://developers.cloudflare.com/workers/learning/how-workers-works)
- [Sveltekit + Sass](https://blog.hao.dev/how-to-add-scss-or-sass-to-sveltekit)
- [Cloudflare Global Network](https://www.cloudflare.com/network/)
- [Faster Websites](https://www.cloudflare.com/resources/images/slt3lc6tev37/1PdxTNFdaTagVJ1zxxTKCX/5fcc6da3f0a170414a8b8f9c7cd405d5/Getting_Faster_-_Performance_whitepaper.pdf)
- [Relative Time](https://www.js-howto.com/how-to-format-dates-with-intl-relativetimeformat/)
- [5 Ways to Maximize the Security, Performance and Reliability of Your Online Business](https://info.cloudflare.com/rs/713-XSC-918/images/Secure_Fast_Reliable_eBook.pdf)
- [Cloudflare + MailChannels + DKIM](https://mailchannels.zendesk.com/hc/en-us/articles/7122849237389)
- [Sveltekit page transitions](https://joshcollinsworth.com/blog/sveltekit-page-transitions#the-final-code)
- [SVG Viewbox](https://webdesign.tutsplus.com/svg-viewport-and-viewbox-for-beginners--cms-30844t)
- [Svelete Store + Local Storage](https://rodneylab.com/using-local-storage-sveltekit/)
- [Get Paypal Credentials](https://developer.paypal.com/api/rest/#get-credentials)
- [Customize Paypal Checkout Page](https://developer.paypal.com/api/nvp-soap/paypal-payments-standard/admin/checkout-settings/)
- [Transition between height 0 and auto](https://www.youtube.com/watch?v=B_n4YONte5A)
- [Best Practices for Returns and Refunds in eCommerce](https://www.clickpost.ai/blog/ecommerce-returns-best-practices)
- [SameSite cookies explained](https://web.dev/articles/samesite-cookies-explained)
- [Everything you always wanted to know about touch icons](https://mathiasbynens.be/notes/touch-icons)
- [Typescript + Browsers](https://medium.com/@salathielgenese/setup-typescript-for-modern-browser-a75d699673f6)
- [Jest + ES6](https://jestjs.io/docs/ecmascript-modules)
- [Best time to publish on YouTube](https://www.tubebuddy.com/blog/best-time-to-publish-video-youtube/)
- [Node command line package](https://x-team.com/blog/a-guide-to-creating-a-nodejs-command/)
- [Mongodb Full Text Search](https://www.mongodb.com/basics/full-text-search)
- [Mongodb Search Scoring](https://www.mongodb.com/docs/atlas/atlas-search/scoring/)
- [Mongodb Search Analyzers](https://www.mongodb.com/docs/atlas/atlas-search/analyzers/language/)
- [Neo4j System](https://neo4j.com/docs/operations-manual/current/database-administration/)
- [Neo4j Access Control](https://neo4j.com/docs/operations-manual/current/tutorial/access-control/)
- [Neo4j Auth](https://neo4j.com/docs/operations-manual/current/authentication-authorization/)
- [What is a graph](https://aws.amazon.com/nosql/graph/)
- [Neo4j + LLM](https://graphacademy.neo4j.com/courses/llm-fundamentals/1-introduction/1-neo4j-and-genai/)
- [Cloudflare Cookies](https://developers.cloudflare.com/fundamentals/reference/policies-compliances/cloudflare-cookies/)
- [Cloudflare Database Integrations](https://developers.cloudflare.com/workers/databases/native-integrations/)
- [Sign and Verify Messages with Web Crypto API](https://bradyjoslin.com/blog/hmac-sig-webcrypto/)
- [FS Open Write Files](https://brainbell.com/javascript/fs-open-read-write-file.html)
- [Deep Clone](https://developer.mozilla.org/en-US/docs/Web/API/structuredClone)
- [Tanstack Query + Websockets](https://tkdodo.eu/blog/using-web-sockets-with-react-query)
- [Next.js + Websockets](https://socket.io/how-to/use-with-nextjs)
- [Next.js + Custom Server](https://nextjs.org/docs/app/building-your-application/configuring/custom-server)

#### Utilities
- [Squoosh](https://squoosh.app)
- [SVG Icons](https://icones.js.org/collection/all)
- [Flowbite](https://flowbite-svelte.com/)
- [Jwt.io](https://jwt.io/)
- [White to Grey Hex's](https://www.htmlcolor-picker.com/color-groups/white-grey-black)
- [CSP Validator](https://csp-evaluator.withgoogle.com/)
- [DNS Checker](https://dnschecker.org)
- [Emoji's](https://www.iemoji.com/) or [Command + Cotrol + Spacebar]
- [Open Graph Preview](https://www.opengraph.xyz)
- [SVG to PNG](https://svgtopng.com/)
- [SVG Formatter](https://htmlformatter.com/)
- [AI Image Generator](https://playgroundai.com/create)
- [AI Photo to Art](https://www.befunky.com/create/photo-to-art/)
- [Movie Green Screen Videos](https://pixabay.com/videos/)
- [MOV to GIF](https://ezgif.com/video-to-gif)
- [SVG to JSX](https://react-svgr.com/playground/?native=true&typescript=true)
- [Tailwind Cheatsheet](https://nerdcave.com/tailwind-cheat-sheet)


#### Tech Stack Costs
- [MailChannels: FREE for Infinite Outbound API Emails/month](https://community.cloudflare.com/t/send-email-from-workers-using-mailchannels-for-free/361973)
- [Namecheap: $8.16/year for Domain Registration](https://www.namecheap.com/domains/)
- [Github Team: $4/month for 2G of storage](https://github.com/pricing)
- [Cloudflare Workers: $5/month for 285 servers allowing 10 million requests/month, 100,000 KV reads/day, 1,000 KV writes/day and 1 GB of KV storage allowed](https://developers.cloudflare.com/workers/platform/pricing)
- [Proton Business: $19.98/month for a secure email inbox, calendar, and 1,000GB of cloud storage](https://proton.me/business/plans)


#### Local install
1. [Install git](https://github.com/git-guides/install-git)
1. [Install node & npm](https://nodejs.org/en/download/)
1. [Install nvm](https://github.com/nvm-sh/nvm)
1. In [bash](https://opensource.com/resources/what-bash) navigate to the place you would love to place this code
```bash
git clone https://github.com/feelinglovelynow/feelinglovelynow.git
cd feelinglovelynow
nvm use 18
npm install -g pnpm
pnpm setup
source /Users/[ username ]/.zshrc
pnpm i
```


#### Start development server
```bash
pnpm dev
```


#### Validates code & then pushes to [github main branch](https://github.com/feelinglovelynow/feelinglovelynow/tree/main)
```bash
pnpm mainPush
```


#### Deploy to [production](https://feelinglovelynow.com)
```bash
pnpm mainDeploy
```


#### View logs for production server
```bash
pnpm mainLogs
```


#### View logs for qa server
```bash
pnpm qaLogs
```


#### [Updates all dependencies](https://pnpm.io/cli/update)
```bash
pnpm up
```


#### Set default tab size in [VSCodium](https://vscodium.com/) to 2 for new files
Preferences > Settings > JSON
```json
{
  "editor.tabSize": 2
}
```


#### Show what folder we are in @ the tab level of [VSCodium](https://vscodium.com/)
Preferences > Settings > JSON
```json
{
  "workbench.editor.labelFormat": "short"
}
```


#### Stop [VSCodium](https://vscodium.com/) from compacting folders in sidenav
Preferences > Settings > JSON
```json
{
  "explorer.compactFolders": false
}
```


#### Increase indent for sub folders in [VSCodium](https://vscodium.com/) sidenav
Preferences > Settings > JSON
```json
{
  "workbench.tree.indent": 18
}
```


#### Get project wide typescript reporting in [VSCodium](https://vscodium.com/)
* Turn this off when getting errors in `node_modules`
Preferences > Settings > JSON
```json
{
 "typescript.tsserver.experimental.enableProjectDiagnostics": true
}
```


#### Show autocomplete suggestions in [VSCodium](https://vscodium.com/)
```
Control + Space
```


#### Reload [VSCodium](https://vscodium.com/)
This is helpful when type definitions are stale (showing incorrect errors)
```
Command + Shift + P
Developer: Reload Window
```


## How to create an NPM Package
1. Bash `mkdir example && cd example && touch tsconfig.json && touch tsconfig.build.json && pnpm init && pnpm i typescript -D`
```json
// tsconfig.build.json
{
  "files": [], // all src files (including index.js) (not including .test.js)
  "compilerOptions": {
    "allowJs": true,
    "checkJs": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "sourceMap": true,
    "declaration": true,
    "strict": true,
    "outDir": "tsc",
    "declarationMap": true,
    "module": "NodeNext", // use ESNext if .svelte components in /src
    "target": "ES2017"
  }
}

// tsconfig.json
{
  "files": [], // all src files with a .js extension
  "compilerOptions": {
    "noEmit": true,
    "allowJs": true,
    "checkJs": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "strict": true,
    "module": "NodeNext",
    "target": "ES2017"
  }
}

```

1. Add `src` folder AND put `.js` or `.svetle` code in there AND ensure all imports w/in `src` have `.js` extension AND ensure no `exports` are `default`
1. IF adding a `typedefs.js` file and there are no imports in the file => at the end of the file add `export {}`
1. Create `./src/index.js` file and put all exports in there from `src` folder
1. IF svelte component is in `src` => Export in `index.js` like this: `export { default as Example } from './Example.svelte'`
1. IF svelte component is in `src` => Add `Example.svelte.d.ts`
```ts
import { SvelteComponent } from 'svelte'


export default class Example extends SvelteComponent<{
  css?: string
  label?: string
  href?: string
  widthRem?: number
}> {}
```
1. IF file in `src` updates `window` at the top of the file add `/// <reference path="./types.d.ts" />` and in that file put
```ts
declare global { // Node global types
  interface Window { // Browser window types
    flnToastWrapper: HTMLElement | null | undefined
  }
}

export {}
```
1. Put all `src` files w/ `.js` extension into `tsconfig.json` files array
1. Bash `pnpm tsc -p tsconfig.build.json -w`
1. Create `./src/index.ts` file and put all `.d.ts` exports in there from `tsc` folder (only put extension as `.d`), do not include `index.d`
1. IF `src` folder has a `types.d.ts` file => Include `export * from './types.d'` in `index.ts` file
1. IF svelte component is in `src` => Export in `index.ts` like this: `export { default as Example } from './Example.svelte'`
1. Bash `touch esbuild.js && pnpm i esbuild -D`
```ts
import esbuild from 'esbuild'


esbuild.build({ // // https://esbuild.github.io/api/
  logLevel: 'info', // Show warnings, errors, and an output file summary. 
  sourcemap: true, // Source maps can make it easier to debug your code. They encode the information necessary to translate from a line/column offset in a generated output file back to a line/column offset in the corresponding original input file. 
  minify: true, // When enabled, the generated code will be minified instead of pretty-printed. 
  outdir: './dist', // Sets the output directory for the build operation.
  entryPoints: [ // This is an array of files that each serve as an input to the bundling algorithm.
    './tsc/DgraphTransaction.js',
    './tsc/enumContentType.js',
    './tsc/index.js',
    './tsc/typedefs.js',
  ],
})
```
1. Populate `esbuild.js` with all `.js` files that will go from the `tsc` folder to the the `dist` folder - [build options](https://esbuild.github.io/api/)
1. Bash `touch build.sh`
```bash
#!/bin/bash
pnpm test &&
npx istanbul-badges-readme --statementsLabel='Coverage' &&
rm -rf ./dist ./tsc &&
pnpm tsc -p tsconfig.build.json &&
node ./esbuild.js &&
cp ./src/index.ts ./dist/index.ts
```
1. IF Svelte component is in `src` => Bash: `pnpm add svelte -D`
1. IF Svelte component is in `src` => add `cp` like this: `cp ./src/Example.svelte ./dist/Example.svelte` and add `cp ./src/Example.svelte.d.ts ./dist/Example.svelte.d.ts`
1. IF `types.d.ts` is in `src` => add `cp` like this: `cp ./src/types.d.ts ./dist/types.d.ts`
1. IF CSS files in `src` => add `cp` like this: `cp ./src/example.css ./dist/example.css`
1. Add MIT `LICENSE` to root folder
1. Add `README.md` to root folder
1. Add to `README.md`
```md
## 🤓 Unit Tests
![Statements](https://img.shields.io/badge/Coverage-100%25-brightgreen.svg?style=flat)
```
1. Bash `touch jest.config.js && pnpm i jest -D && pnpm i @jest/globals -D`
```js
/** @type { import('jest').Config } */
const config = { // https://jestjs.io/docs/configuration
  clearMocks: true, // Automatically clear mock calls, instances, contexts and results before every test
  collectCoverage: true, // Indicates whether the coverage information should be collected while executing the test
  coverageDirectory: 'coverage', // The directory where Jest should output its coverage files
  coverageProvider: 'v8', // Indicates which provider should be used to instrument code for coverage
  injectGlobals: false, // Insert Jest's globals (expect, test, describe, beforeEach etc.) into the global environment. If you set this to false, you should import from @jest/globals
}

export default config
```
1. IF `jest` tests will have any DOM tests or tests for any `.svelte` files => Bash `pnpm i jest-environment-jsdom -D` AND add to `jest.config.js`
```js
{
  testEnvironment: 'jest-environment-jsdom', // The test environment that will be used for testing. The default environment in Jest is a Node.js environment. If you are building a web app, you can use a browser-like environment via 'jest-environment-jsdom'
}
```
1. IF `jest` tests will have any `.svelte` files => Bash `pnpm i @testing-library/svelte -D && pnpm i svelte-jester -D` AND add to `jest.config.js`
```js
{
  moduleFileExtensions: ['js', 'svelte'], // An array of file extensions your modules use
  extensionsToTreatAsEsm: ['.svelte'], // If you have files that are not `.js` and `.cjs` that should run with native ESM, you need to specify their file extension here
  transform: { '^.+\\.svelte$': 'svelte-jester' }, // https://www.npmjs.com/package/svelte-jester
}
```
1. Remove `main` from `package.json`
1. Add `description` to `package.json`
1. Add to `package.json`
```json
{
  "author": "https://github.com/feelinglovelynow?tab=repositories",
  "license": "MIT",
  "type": "module",
  "types": "./dist/index.ts",
  "exports": "./dist/index.js",
  "files": [
    "dist",
    "tsc",
    "src"
  ],
  "keywords": [

  ],
  "scripts": {
    "watch": "pnpm tsc -w",
    "build": "bash ./build.sh",
    "cloud": "pnpm build && pnpm publish --access public .",
    "test": "NODE_OPTIONS=--experimental-vm-modules pnpm jest"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/feelinglovelynow/example.git"
  },
  "bugs": {
    "url": "https://github.com/feelinglovelynow/example/issues"
  }
}
```
1. Update `package.json` [ `name`, `keywords`, `repository`, `bugs` ]
1. If there is a `svelte` component in this package add to `package.json` - [guidance](https://github.com/hperrin/svelte-material-ui/issues/375)
```json
{
  "main": "./dist/index.js",
  "svelte": "./dist/index.js",
}
```
1. IF there is a `.css` file in `./src` => add to `package.json`
```json
{
  "exports": {
    ".": "./dist/index.js",
    "./index.css": "./dist/index.css"
  },
}
```
1. Bash `touch .gitignore`
```toml
coverage
dist
node_modules
tsc
```
1. In `./src` folder add a `__tests__` folder and in it add a `.test.js` file for each `.js` file in `./src` that is not `./src/index.js` or `./src/typedefs.js`
1. Bash `pnpm build`
1. In another app link to this package locally `"example": "link:../example"`
1. Publish package to npm


### Publish package to npm
```bash
pnpm whoami
pnpm login
pnpm publish --access public .
```


## Deprecate an npm package
```bash
npm deprecate @sensethenlove/toast@1.x "This project has been renamed. Install using @feelinglovelynow/toast instead."
```


## Different Ace Options
* `"@ace/db": "file:../acedatabasefoundation/db",`
* `"@ace/db": "git+https://github.com/acedatabasefoundation/db.git",`


## Github Desktop Error
* Error: The remote disconnected. Check your Internet connection and try again.
* Fix: `git config --global http.postBuffer 157286400`
* Source: [Link](https://github.com/desktop/desktop/issues/14936)


## Navigate Filezilla
1. File
1. Site Manger
1. Connect


## Digital Ocean Links
* [NodeJS](https://www.digitalocean.com/community/tutorials/how-to-set-up-a-node-js-application-for-production-on-ubuntu-20-04)
* [Filezilla](https://docs.digitalocean.com/products/droplets/how-to/transfer-files/)
* [NVM](https://www.digitalocean.com/community/tutorials/how-to-install-node-js-on-ubuntu-16-04)


### Digital Ocean Scripts
* Always allow ssh in the firewall
    * `sudo ufw allow ssh`
* Git Pull + Deploy
    * `cd /var/www/feelinglovelynow && git pull && npm run build && pm2 restart index`
* After updating sites available
    * `sudo ln -s /etc/nginx/sites-available/feelinglovelynow /etc/nginx/sites-enabled/`
    * `sudo systemctl restart nginx`
